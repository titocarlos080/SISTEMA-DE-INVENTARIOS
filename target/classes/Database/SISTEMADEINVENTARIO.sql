
/**
 * Author:  hp
 * Created: 16 mar. de 2023
 */
CREATE DATABASE SISTEMADEINVENTARIO;
USE SISTEMADEINVENTARIO;
 
CREATE TABLE CATEGORIA(
ID INT NOT NULL,
DESCRIPCION VARCHAR(40) NOT NULL UNIQUE,
PRIMARY KEY(ID)
);
-- ALTER TABLE CATEGORIA 
-- MODIFY COLUMN DESCRIPCION VARCHAR(40) NOT NULL UNIQUE;
-- 
-- INSERT INTO CATEGORIA VALUES(1,"FUNGICIDAS");
-- UPDATE CATEGORIA SET DESCRIPCION= "FUNGI" ,ID=45 WHERE ID=1;

-- SELECT DESCRIPCION FROM CATEGORIA;
-- select * FROM CATEGORIA;

CREATE TABLE PRODUCTO(
CODIGO BIGINT NOT NULL,
NOMBRE VARCHAR(40) NOT NULL,
CANTIDAD INT NOT NULL,
PRECIO DOUBLE NOT  NULL,
FOTO BLOB,
IDCATEGORIA INT NOT NULL,
PRIMARY KEY(CODIGO),
FOREIGN KEY(IDCATEGORIA) REFERENCES CATEGORIA(ID)
ON DELETE CASCADE
ON UPDATE CASCADE
);
-- INSERT INTO PRODUCTO VALUES (111111,"CORAZA",50,40,NULL,1);
-- INSERT INTO PRODUCTO VALUES (22222,"DITANE",100,40,NULL,1);
-- SELECT CODIGO,NOMBRE,CANTIDAD,PRECIO FROM PRODUCTO;
-- select * FROM PRODUCTO;
-- select * FROM CATEGORIA;
-- SELECT CODIGO,NOMBRE,CANTIDAD,PRECIO,FOTO,DESCRIPCION FROM PRODUCTO,CATEGORIA WHERE ID=IDCATEGORIA AND DESCRIPCION="ABONOS";

CREATE TABLE PERSONA(
CI INT NOT NULL,
NOMBRE VARCHAR(150) NOT NULL,
SEXO VARCHAR(1) NOT NULL,
TELEFONO VARCHAR(40) ,
FOTO BLOB,
TIPOCLIENTE BOOLEAN NOT NULL,
TIPOVENDEDOR BOOLEAN NOT NULL,
PRIMARY KEY(CI) 
);
-- INSERT INTO PERSONA VALUES(9441550,"TITO CARLOS GUTIERREZ","M",72465939,NULL,FALSE,TRUE);
-- INSERT INTO PERSONA VALUES(3333333,"PEDRO GUZMAN TORREZ","M",5447855,NULL,FALSE,TRUE);
-- SELECT * FROM PERSONA;

CREATE TABLE CLIENTE(
CIPERSONA INT NOT NULL,
CUOTA DOUBLE NOT NULL,
PRIMARY KEY(CIPERSONA),
FOREIGN KEY(CIPERSONA) REFERENCES PERSONA(CI)
ON DELETE CASCADE
ON UPDATE CASCADE
);

CREATE TABLE CATEGORIAVENDEDOR(
ID INT NOT NULL,
DESCCRIPCION VARCHAR(50) NOT NULL,
PRIMARY KEY(ID)
);
-- INSERT INTO CATEGORIAVENDEDOR VALUES(1,"ADMINISTRADOR");
-- INSERT INTO CATEGORIAVENDEDOR VALUES(2,"VENDEDOR");
-- INSERT INTO CATEGORIAVENDEDOR VALUES(3,"AYUDANTE");

CREATE TABLE VENDEDOR(
CIPERSONA INT NOT NULL,
CODIGO VARCHAR(30) NOT NULL,
CONTRASEÃ‘A VARCHAR(30) NOT NULL,
IDCATEGORIAVENDEDOR INT NOT NULL,
FOREIGN KEY(CIPERSONA) REFERENCES PERSONA(CI)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY(IDCATEGORIAVENDEDOR) REFERENCES CATEGORIAVENDEDOR(ID)
ON DELETE CASCADE
ON UPDATE CASCADE
);
--  INSERT INTO VENDEDOR VALUES(9441550,"ADMVENTA","QWERTY",1);
--  INSERT INTO VENDEDOR VALUES(3333333,"COD","PAS",3);
-- SELECT * FROM VENDEDOR;
-- SELECT CODIGO FROM VENDEDOR WHERE CODIGO="ADMVENTA";
-- SELECT CI,CODIGO,NOMBRE,DESCCRIPCION 
-- FROM PERSONA,VENDEDOR,CATEGORIAVENDEDOR
-- WHERE PERSONA.CI=VENDEDOR.CIPERSONA AND VENDEDOR.IDCATEGORIAVENDEDOR=CATEGORIAVENDEDOR.ID;

CREATE TABLE FACTURA(
CODIGO INT AUTO_INCREMENT NOT NULL,
FECHA DATE NOT NULL,
MONTO DOUBLE NOT NULL,
ESTADODEPAGO BOOLEAN NOT NULL,
CIPERSONA INT NOT NULL,
HORA TIME NOT NULL
PRIMARY KEY(CODIGO),
FOREIGN KEY(CIPERSONA) REFERENCES PERSONA(CI)
ON DELETE CASCADE
ON UPDATE CASCADE
);

CREATE TABLE DETALLEFACTURA(
CODIGOFACTURA INT NOT NULL,
CODIGOPRODUCTO BIGINT NOT NULL,
CANTIDAD INT NOT NULL,
PRECIOVENTA DOUBLE NOT NULL,
TOTALPARCIAL DOUBLE NOT NULL,
PRIMARY KEY(CODIGOFACTURA,CODIGOPRODUCTO),
FOREIGN KEY(CODIGOFACTURA) REFERENCES FACTURA(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY(CODIGOPRODUCTO) REFERENCES PRODUCTO(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE

);




